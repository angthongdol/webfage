<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>‡∏á‡∏ö‡∏ó‡∏î‡∏•‡∏≠‡∏á (‡πÅ‡∏¢‡∏Å‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì/‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô)</title>
  <style>
    :root {
      --bg: #0f172a;          /* slate-900 */
      --panel: #111827;       /* gray-900 */
      --panel-2: #0b1220;     /* custom */
      --muted: #94a3b8;       /* slate-400 */
      --text: #e5e7eb;        /* gray-200 */
      --primary: #22d3ee;     /* cyan-400 */
      --primary-2: #67e8f9;   /* cyan-300 */
      --accent: #a78bfa;      /* violet-400 */
      --ring: #1f2937;        /* gray-800 */
      --ok: #34d399;          /* emerald-400 */
      --warn: #f59e0b;        /* amber-500 */
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji";
      background: linear-gradient(180deg, var(--bg), #0b1020 50%, #070b16 100%);
      color: var(--text);
    }
    header {
      padding: 18px 20px; position: sticky; top: 0; z-index: 50; backdrop-filter: blur(8px);
      background: linear-gradient(180deg, rgba(15,23,42,.85), rgba(15,23,42,.65));
      border-bottom: 1px solid var(--ring);
      display: grid; grid-template-columns: 1fr auto; gap: 12px; align-items: center;
    }
    .brand { display: flex; align-items: center; gap: 12px; }
    .logo { width: 36px; height: 36px; border-radius: 10px; background: radial-gradient(circle at 30% 20%, var(--primary), var(--accent)); box-shadow: 0 0 24px rgba(103,232,249,.35); }
    .title { font-size: clamp(16px, 2vw, 20px); font-weight: 700; letter-spacing: .2px; }
    .subtitle { font-size: 12px; color: var(--muted); }

    .layout { display: grid; grid-template-columns: 320px 1fr; height: calc(100vh - 76px); }
    @media (max-width: 1024px) { .layout { grid-template-columns: 1fr; height: auto; } }

    /* Sidebar */
    .sidebar {
      border-right: 1px solid var(--ring); background: linear-gradient(180deg, var(--panel), var(--panel-2));
      overflow: auto; padding: 16px; position: relative;
    }
    @media (max-width: 1024px) { .sidebar { height: auto; max-height: 50vh; } }

    .search {
      display: grid; grid-template-columns: 1fr 40px; gap: 8px; align-items: center; margin-bottom: 12px;
    }
    .search input {
      width: 100%; padding: 10px 12px; border-radius: 12px; border: 1px solid var(--ring); background: #0b1220; color: var(--text);
      outline: none; box-shadow: inset 0 0 0 1px transparent; transition: box-shadow .15s ease, border-color .15s ease;
    }
    .search input:focus { border-color: var(--primary); box-shadow: inset 0 0 0 1px var(--primary); }
    .search button { height: 40px; border-radius: 12px; border: 1px solid var(--ring); background: #0b1220; color: var(--text); cursor: pointer; }

    .hint { font-size: 12px; color: var(--muted); margin: 6px 2px 12px; }

    details.year { border: 1px solid var(--ring); border-radius: 14px; margin-bottom: 10px; overflow: hidden; background: rgba(255,255,255,0.02); }
    details[open].year { box-shadow: 0 0 0 1px rgba(103,232,249,.2), 0 8px 30px rgba(0,0,0,.3); }
    summary.year-head { list-style: none; padding: 12px 14px; cursor: pointer; display: flex; align-items: center; justify-content: space-between; }
    summary.year-head::-webkit-details-marker { display: none; }
    .year-title { display: flex; align-items: baseline; gap: 10px; }
    .badge { font-size: 11px; color: #0b1220; background: linear-gradient(90deg, var(--primary), var(--primary-2)); padding: 4px 8px; border-radius: 999px; font-weight: 700; }

    .months { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; padding: 12px; border-top: 1px dashed var(--ring); background: rgba(10,16,30,.6); }
    @media (max-width: 480px) { .months { grid-template-columns: repeat(2, 1fr); } }

    .month-btn { border: 1px solid var(--ring); border-radius: 12px; padding: 10px 12px; background: #0a1020; color: var(--text); cursor: pointer; text-align: left; display: grid; gap: 4px; transition: transform .06s ease, border-color .15s ease, box-shadow .15s ease; }
    .month-btn:hover { border-color: var(--primary); box-shadow: 0 0 0 1px rgba(34,211,238,.25); transform: translateY(-1px); }
    .month-btn[data-available="false"] { opacity: .55; cursor: not-allowed; }
    .month-btn .meta { font-size: 11px; color: var(--muted); }

    /* Viewer */
    .viewer { position: relative; background: #050914; }
    .viewer .toolbar {
      position: sticky; top: 0; display: flex; gap: 8px; align-items: center; padding: 10px; border-bottom: 1px solid var(--ring);
      background: linear-gradient(180deg, rgba(5,9,20,.9), rgba(5,9,20,.82)); backdrop-filter: blur(8px);
    }
    .btn { border: 1px solid var(--ring); border-radius: 10px; background: #0b1220; color: var(--text); padding: 8px 12px; cursor: pointer; }
    .btn[disabled] { opacity: .6; cursor: not-allowed; }
    .crumbs { margin-left: auto; font-size: 12px; color: var(--muted); }

    .pdf-wrap { height: calc(100vh - 76px - 52px); }
    @media (max-width: 1024px) { .pdf-wrap { height: 70vh; } }

    iframe { width: 100%; height: 100%; border: 0; background: #0a0f1e; }
    .placeholder { height: 100%; display: grid; place-items: center; color: var(--muted); text-align: center; padding: 24px; }
  </style>
</head>
<body>
  <header>
    <div class="brand">
      <div class="logo" aria-hidden="true"></div>
      <div>
        <div class="title">‡∏á‡∏ö‡∏ó‡∏î‡∏•‡∏≠‡∏á ‚Ä¢ ‡πÅ‡∏¢‡∏Å‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì / ‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</div>
        <div class="subtitle">‡∏Ñ‡∏•‡∏¥‡∏Å‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏ü‡∏•‡πå PDF</div>
      </div>
    </div>
    <div class="subtitle">FY = ‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì (‡∏ï.‡∏Ñ. ‡∏ñ‡∏∂‡∏á ‡∏Å.‡∏¢.)</div>
  </header>

  <main class="layout">
    <!-- Sidebar: ‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì & ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô -->
    <aside class="sidebar">
      <div class="search">
        <input id="searchYear" type="search" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì ‡πÄ‡∏ä‡πà‡∏ô 2568" />
        <button id="clearSearch" title="‡∏•‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤">‚úï</button>
      </div>
      <div class="hint">‡πÉ‡∏™‡πà‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÑ‡∏ü‡∏•‡πå PDF ‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÉ‡∏ô‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ <code>DATA</code> ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏ó‡πâ‡∏≤‡∏¢‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏µ‡πâ</div>
      <div id="yearList" aria-live="polite"></div>
    </aside>

    <!-- Viewer: ‡πÅ‡∏™‡∏î‡∏á PDF -->
    <section class="viewer">
      <div class="toolbar">
        <button id="btnOpenNew" class="btn" disabled>‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ô‡πÅ‡∏ó‡πá‡∏ö‡πÉ‡∏´‡∏°‡πà</button>
        <a id="btnDownload" class="btn" href="#" download style="text-decoration:none; pointer-events:none;">‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î</a>
        <div class="crumbs" id="crumbs">‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå</div>
      </div>
      <div class="pdf-wrap" id="pdfWrap">
        <div class="placeholder">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏µ/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô<br/>‡πÇ‡∏õ‡∏£‡∏î‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡πÅ‡∏ñ‡∏ö‡∏î‡πâ‡∏≤‡∏ô‡∏ã‡πâ‡∏≤‡∏¢</div>
      </div>
    </section>
  </main>

  <script>
    /*
     * === ‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô ===
     * 1) ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ DATA ‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á ‡πÉ‡∏™‡πà‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì (‡πÄ‡∏ä‡πà‡∏ô 2568) ‡πÅ‡∏•‡∏∞‡∏•‡∏¥‡∏á‡∏Å‡πå PDF ‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
     * 2) ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ß‡πà‡∏≤‡∏á‡πÉ‡∏´‡πâ‡πÉ‡∏™‡πà‡∏Ñ‡πà‡∏≤‡∏ß‡πà‡∏≤‡∏á "" ‡∏´‡∏£‡∏∑‡∏≠ null ‡πÑ‡∏î‡πâ ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏∏‡πà‡∏°‡∏à‡∏≤‡∏á ‡πÜ
     * 3) ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å (https://...) ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏ü‡∏•‡πå‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå (‡πÄ‡∏ä‡πà‡∏ô pdfs/2568/10.pdf)
     * 4) ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏õ‡∏µ‡∏à‡∏≤‡∏Å‡∏°‡∏≤‡∏Å‡πÑ‡∏õ‡∏ô‡πâ‡∏≠‡∏¢‡πÇ‡∏î‡∏¢‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
     */

    // üóÇÔ∏è ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‚Äî ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ï‡∏≤‡∏°‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏à‡∏£‡∏¥‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
    const DATA = [
      {
        fy: 2569,
        months: {
          "‡∏ï.‡∏Ñ.": "upfile/TBOCT2568.pdf",
          "‡∏û.‡∏¢.": "",
          "‡∏ò.‡∏Ñ.": "",
          "‡∏°.‡∏Ñ.": "",
          "‡∏Å.‡∏û.": "",
          "‡∏°‡∏µ.‡∏Ñ.": "",
          "‡πÄ‡∏°.‡∏¢.": "",
          "‡∏û.‡∏Ñ.": "",
          "‡∏°‡∏¥.‡∏¢.": "",
          "‡∏Å.‡∏Ñ.": "",
          "‡∏™.‡∏Ñ.": "",
          "‡∏Å.‡∏¢.": "",
        }
      },
      {
        fy: 2568,
        months: {
          "‡∏ï.‡∏Ñ.": "upfile/TBOCT2567.pdf",
          "‡∏û.‡∏¢.": "upfile/TBNOV2567.pdf",
          "‡∏ò.‡∏Ñ.": "upfile/TBDEC2567.pdf",
          "‡∏°.‡∏Ñ.": "upfile/TBJAN2568.pdf",
          "‡∏Å.‡∏û.": "upfile/TBFEB2568.pdf",
          "‡∏°‡∏µ.‡∏Ñ.": "upfile/TBMARCH2568.pdf",
          "‡πÄ‡∏°.‡∏¢.": "upfile/TBAP2568.pdf",
          "‡∏û.‡∏Ñ.": "upfile/TBMAY2568.pdf",
          "‡∏°‡∏¥.‡∏¢.": "upfile/TBJUNE2568.pdf",
          "‡∏Å.‡∏Ñ.": "upfile/TBJULY2568.pdf",
          "‡∏™.‡∏Ñ.": "upfile/TBAUG2568.pdf",
          "‡∏Å.‡∏¢.": "upfile/TBSEP2568.pdf"
        }
      },
      {
        fy: 2567,
        months: {
          "‡∏ï.‡∏Ñ.": "upfile/TBOCT2566.pdf",
          "‡∏û.‡∏¢.": "upfile/TBNOV2566.pdf",
          "‡∏ò.‡∏Ñ.": "upfile/TBDEC2566.pdf",
          "‡∏°.‡∏Ñ.": "upfile/TBJAN2567.pdf",
          "‡∏Å.‡∏û.": "upfile/TBFEB2567.pdf",
          "‡∏°‡∏µ.‡∏Ñ.": "upfile/TBMarch2567.pdf",
          "‡πÄ‡∏°.‡∏¢.": "upfile/TBAP2567.pdf",
          "‡∏û.‡∏Ñ.": "upfile/TBMAY2567.pdf",
          "‡∏°‡∏¥.‡∏¢.": "upfile/TBJUNE2567.pdf",
          "‡∏Å.‡∏Ñ.": "upfile/TBJULY2567.pdf",
          "‡∏™.‡∏Ñ.": "upfile/TBAUG2567.pdf",
          "‡∏Å.‡∏¢.": "pdfs/2567/09.pdf"
        }
      }
    ];

    // ‡∏•‡∏≥‡∏î‡∏±‡∏ö‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ï‡∏≤‡∏°‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡πÑ‡∏ó‡∏¢ (‡∏ï.‡∏Ñ. ‚Üí ‡∏Å.‡∏¢.)
    const FY_MONTHS = ["‡∏ï.‡∏Ñ.", "‡∏û.‡∏¢.", "‡∏ò.‡∏Ñ.", "‡∏°.‡∏Ñ.", "‡∏Å.‡∏û.", "‡∏°‡∏µ.‡∏Ñ.", "‡πÄ‡∏°.‡∏¢.", "‡∏û.‡∏Ñ.", "‡∏°‡∏¥.‡∏¢.", "‡∏Å.‡∏Ñ.", "‡∏™.‡∏Ñ.", "‡∏Å.‡∏¢."];

    const yearList = document.getElementById('yearList');
    const searchYear = document.getElementById('searchYear');
    const clearSearch = document.getElementById('clearSearch');
    const pdfWrap = document.getElementById('pdfWrap');
    const crumbs = document.getElementById('crumbs');
    const btnOpenNew = document.getElementById('btnOpenNew');
    const btnDownload = document.getElementById('btnDownload');

    let current = { fy: null, month: null, url: null };

    function renderYears(filter = '') {
      yearList.innerHTML = '';
      const sorted = [...DATA].sort((a, b) => b.fy - a.fy);
      for (const { fy, months } of sorted) {
        if (filter && !String(fy).includes(filter.trim())) continue;
        const el = document.createElement('details');
        el.className = 'year';
        el.setAttribute('data-fy', fy);
        // ‡πÄ‡∏õ‡∏¥‡∏î‡∏õ‡∏µ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡πÇ‡∏î‡∏¢‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ (‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á)
        if (!filter && yearList.childElementCount === 0) el.open = true;

        const sum = document.createElement('summary');
        sum.className = 'year-head';
        const titleBox = document.createElement('div');
        titleBox.className = 'year-title';
        titleBox.innerHTML = `<span style="font-weight:800;font-size:16px">FY ${fy}</span>` +
          `<span class="badge">‡∏ï.‡∏Ñ. - ‡∏Å.‡∏¢.</span>`;
        const countAvail = Object.values(months).filter(Boolean).length;
        const meta = document.createElement('div');
        meta.className = 'subtitle';
        meta.textContent = `${countAvail}/12 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô`;
        sum.appendChild(titleBox);
        sum.appendChild(meta);
        el.appendChild(sum);

        const monthsGrid = document.createElement('div');
        monthsGrid.className = 'months';
        for (const m of FY_MONTHS) {
          const url = months[m] || '';
          const btn = document.createElement('button');
          btn.className = 'month-btn';
          btn.setAttribute('data-available', Boolean(url));
          btn.innerHTML = `<div>${m}</div><div class="meta">${url ? '‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå' : '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î'}</div>`;
          btn.addEventListener('click', () => openPDF(fy, m, url));
          monthsGrid.appendChild(btn);
        }
        el.appendChild(monthsGrid);
        yearList.appendChild(el);
      }

      if (!yearList.childElementCount) {
        const empty = document.createElement('div');
        empty.className = 'hint';
        empty.textContent = '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏Ñ‡∏≥‡∏Ñ‡πâ‡∏ô';
        yearList.appendChild(empty);
      }
    }

    function openPDF(fy, month, url) {
      current = { fy, month, url: url || null };
      crumbs.textContent = url ? `FY ${fy} ‚Ä¢ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ${month}` : `FY ${fy} ‚Ä¢ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ${month} (‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå)`;

      // ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏™‡∏£‡∏¥‡∏°
      if (url) {
        btnOpenNew.disabled = false;
        btnOpenNew.onclick = () => window.open(url, '_blank');
        btnDownload.style.pointerEvents = 'auto';
        btnDownload.href = url;
      } else {
        btnOpenNew.disabled = true;
        btnOpenNew.onclick = null;
        btnDownload.style.pointerEvents = 'none';
        btnDownload.removeAttribute('href');
      }

      // Viewer
      if (url) {
        pdfWrap.innerHTML = '';
        const frame = document.createElement('iframe');
        frame.title = `‡∏á‡∏ö‡∏ó‡∏î‡∏•‡∏≠‡∏á FY ${fy} ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ${month}`;
        frame.src = url;
        frame.loading = 'eager';
        frame.referrerPolicy = 'no-referrer';
        pdfWrap.appendChild(frame);
      } else {
        pdfWrap.innerHTML = `<div class="placeholder">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå PDF ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ<br/>‡πÇ‡∏õ‡∏£‡∏î‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏•‡∏∞‡πÉ‡∏™‡πà‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÉ‡∏ô‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ <code>DATA</code></div>`;
      }
    }

    // ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
    searchYear.addEventListener('input', () => renderYears(searchYear.value));
    clearSearch.addEventListener('click', () => { searchYear.value = ''; renderYears(); });

    // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
    renderYears();
  </script>
</body>
</html>
